<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head"></head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

    <div th:replace="fragments/navbar :: navbar"></div>
    <div th:replace="fragments/sidebar :: sidebar"></div>

    <div class="content-wrapper">
        <section class="content pt-4">
            <div class="container-fluid">

                <h2>🧾 Editar Factura <span id="invoice-ref" class="text-muted"></span></h2>

                <!-- Información del cliente -->
                <div class="form-group">
                    <label>👤 Cliente</label>
                    <input type="text" id="clienteInfo" class="form-control" readonly>
                </div>

                <form id="facturaForm">
                    <div class="form-group">
                        <label>📄 Descripción</label>
                        <input type="text" id="descripcion" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label>📅 Fecha</label>
                        <input type="date" id="fecha" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label>📌 Estado</label>
                        <select id="estado" class="form-control">
                            <option>DRAFT</option>
                            <option>SENT</option>
                            <option>PAID</option>
                            <option>CANCELLED</option>
                        </select>
                    </div>

                    <h4 class="mt-4">📋 Líneas de Factura</h4>
                    <button type="button" class="btn btn-secondary mb-2"  id="btnAgregarLinea" onclick="agregarLinea()">➕ Añadir línea</button>

                    <table class="table table-bordered">
                        <thead class="thead-dark">
                        <tr>
                            <th>Descripción</th>
                            <th>Cantidad</th>
                            <th>Precio</th>
                            <th>Total</th>
                            <th>Acción</th>
                        </tr>
                        </thead>
                        <tbody id="lineas-factura">
                        <!-- Cargado por JS -->
                        </tbody>
                    </table>

                    <div class="form-group text-right font-weight-bold">
                        Total + IVA: <span id="totalFactura" class="ml-2">0.00 €</span>
                    </div>

                    <div class="mt-3">
                        <button type="button" class="btn btn-success" id="btnGuardar">💾 Guardar</button>
                        <button type="button" class="btn btn-warning" id="btnEmitir">📤 Emitir</button>
                        <button type="button" class="btn btn-primary" id="btnPDF">📎 Ver PDF</button>
                        <button id="btnPagar" class="btn btn-success">💰 Marcar como Pagada</button>
                        <button id="btnCancelar" class="btn btn-warning">❌ Cancelar factura</button>
                        <button type="button" class="btn btn-secondary" onclick="window.location.href='/facturas'">❌ Cancelar edición</button>
                    </div>
                </form>

            </div>
        </section>
    </div>

    <div th:replace="fragments/footer :: footer"></div>

</div>

<!-- Scripts -->
<script th:src="@{/plugins/jquery/jquery.min.js}"></script>
<script th:src="@{/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/dist/js/adminlte.min.js}"></script>
<script th:src="@{/js/factura-editar.js}"></script>

</body>
</html>
